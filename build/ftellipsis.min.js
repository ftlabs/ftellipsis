!function(){"use strict";function a(a,b){a&&(this.el=a,this.container=b&&b.container,this.reRender=b&&b.reRender)}function b(b){b.style.display="none",a.r=b.offsetTop,b.style.display=""}function c(a,b){if(a)for(var c=b&&b.display,d=a.parentNode.children,e=l.call(d,a),f=e+1,g=d.length;g>f;f++)d[f].style.display=c}function d(a,b){var c=a.getClientRects(),d=0;return k(c,function(a){d+=e(a.height,b)}),d}function e(a,b){return Math.floor(a/b)}function f(){var a=document.createElement("test"),b={},c={Webkit:["WebkitColumnCount","WebkitColumnGap"],Moz:["MozColumnCount","MozColumnGap"],ms:["msColumnCount","msColumnGap"],"":["columnCount","columnGap"]};for(var d in c)c[d][0]in a.style&&(b.columnCount=c[d][0],b.columnGap=c[d][1],b[d.toLowerCase()]=!0);return b}function g(a){return parseInt(a[q.columnCount],10)||1}function h(a){return parseInt(a[q.columnGap],10)||0}function i(a){var b=parseInt(a.lineHeight,10);if(!b)throw new Error(p[0]);return b}function j(a){return[a.offsetWidth,a.offsetHeight]}function k(a,b){for(var c=0,d=a.length;d>c&&!b(a[c]);c++);}var l=Array.prototype.indexOf,m=window.getComputedStyle,n="ellipsis-overflowing-child",o="ellipsis-set",p=["The ellipsis container must have line-height set on it"],q=f();a.prototype.calc=function(){if(!this.el)return this;var a=m(this.el),b=j(this.el);return this.columnHeight=b[1],this.columnCount=g(a),this.columnGap=h(a),this.columnWidth=b[0]/this.columnCount,this.lineHeight=i(a),this.deltaHeight=b[1]%this.lineHeight,this.linesPerColumn=Math.floor(this.columnHeight/this.lineHeight),this.totalLines=this.linesPerColumn*this.columnCount,!this.deltaHeight&&this.columnCount>1&&(this.el.style.height=this.columnHeight+"px"),this.child=this.getOverflowingChild(),this},a.prototype.set=function(){return this.el&&this.child?(this.clampChild(),c(this.child.el,{display:"none"}),this.markContainer(),this):this},a.prototype.unset=function(){return this.el&&this.child?(this.el.style.height="",this.unclampChild(this.child),c(this.child.el,{display:""}),this.unmarkContainer(),this.child=null,this):this},a.prototype.destroy=function(){return this.el=this.child=this.container=null,this},a.prototype.getOverflowingChild=function(){var a=this,b={},c=0;return k(this.el.children,function(d){var e,f,g,h=Math.floor(c/a.linesPerColumn)||0;return c+=e=a.getLineCount(d),c>=a.totalLines?(f=c-a.totalLines,g=e-f,b.el=d,b.clampedLines=g,b.clampedHeight=b.clampedLines*a.lineHeight,b.visibleColumnSpan=a.columnCount-h,b.gutterSpan=b.visibleColumnSpan-1,b.applyTopMargin=a.shouldApplyTopMargin(b),q.webkit&&b.clampedLines>1&&(b.clampedHeight+=b.gutterSpan*a.deltaHeight),b):void 0}),b},a.prototype.getLineCount=function(a){return a.offsetWidth>this.columnWidth?d(a,this.lineHeight):e(a.clientHeight,this.lineHeight)},a.prototype.markContainer=function(){this.container&&(this.container.classList.add(o),this.reRender&&b(this.container))},a.prototype.unmarkContainer=function(){this.container&&(this.container.classList.remove(o),this.reRender&&b(this.container))},a.prototype.shouldApplyTopMargin=function(a){var b=a.el;if(q.webkit&&1!==this.columnCount&&!(this.deltaHeight<=3)&&b.previousElementSibling)return 0===b.offsetTop||b.offsetTop===this.columnHeight},a.prototype.clampChild=function(){var a=this.child;a&&a.el&&(a.el.style.height=a.clampedHeight+"px",q.webkit&&(a.el.style.webkitLineClamp=a.clampedLines,a.el.style.display="-webkit-box",a.el.style.webkitBoxOrient="vertical"),this.shouldHideOverflow()&&(a.el.style.overflow="hidden"),a.applyTopMargin&&(a.el.style.marginTop="2em"),a.el.classList.add(n),q.webkit||(a.el.style.position="relative",a.helper=a.el.appendChild(this.helperElement())))},a.prototype.unclampChild=function(a){a&&a.el&&(a.el.style.display="",a.el.style.height="",a.el.style.webkitLineClamp="",a.el.style.webkitBoxOrient="",a.el.style.marginTop="",a.el.style.overflow="",a.el.classList.remove(n),a.helper&&a.helper.parentNode.removeChild(a.helper))},a.prototype.helperElement=function(){var a,b,c=document.createElement("span"),d=this.child.visibleColumnSpan-1;return c.className="ellipsis-helper",c.style.display="block",c.style.height=this.lineHeight+"px",c.style.width="5em",c.style.position="absolute",c.style.bottom=0,c.style.right=0,q.moz&&d&&(a=-(100*d),b=-(d*this.columnGap),c.style.right=a+"%",c.style.marginRight=b+"px",c.style.marginBottom=this.deltaHeight+"px"),c},a.prototype.shouldHideOverflow=function(){var a=this.columnCount>1;return this.columnHeight<this.lineHeight?!0:a?a&&!q.moz:!0},"object"==typeof exports?(module.exports=function(b,c){return new a(b,c)},module.exports.Ellipsis=a):"function"==typeof define&&define.amd?define(function(){return a}):window.Ellipsis=a}();